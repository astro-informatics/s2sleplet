<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>sleplet API documentation</title>
<meta name="description" content="SLEPLET â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>sleplet</code></h1>
</header>
<section id="section-intro">
<h1 id="sleplet">SLEPLET</h1>
<p><a href="https://doi.org/10.5281/zenodo.7268074"><img alt="SLEPLET" src="https://zenodo.org/badge/DOI/10.5281/zenodo.7268074.svg"></a>
<a href="https://www.python.org/downloads/release/python-3100/"><img alt="Python" src="https://img.shields.io/badge/python-3.10-orange.svg"></a>
<a href="https://astro-informatics.github.io/sleplet"><img alt="Documentation" src="https://github.com/astro-informatics/sleplet/actions/workflows/documentation.yml/badge.svg"></a>
<a href="https://github.com/astro-informatics/sleplet/actions/workflows/tests.yml"><img alt="tests" src="https://github.com/astro-informatics/sleplet/actions/workflows/tests.yml/badge.svg"></a>
<a href="https://github.com/pre-commit/pre-commit"><img alt="pre-commit" src="https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit&amp;logoColor=white"></a></p>
<p><code>SLEPLET</code> is a Python package for the construction of Slepian wavelets in the
spherical and manifold (via meshes) settings. The API of <code>SLEPLET</code> has been
designed in an object-orientated manner and is easily extendible. Upon
installation, <code>SLEPLET</code> comes with two command line interfaces - <code>sphere</code> and
<code>mesh</code> - which allows one to easily generate plots on the sphere and a set of
meshes using <code>plotly</code>.</p>
<h2 id="installation">Installation</h2>
<p>Run</p>
<pre><code class="language-sh">pip install -e .
</code></pre>
<p>This will install two scripts <code>sphere</code> and <code>mesh</code> which can be used to generate
the figures in <a href="#paper-figures">the figure section</a>.</p>
<h2 id="bandlimit">Bandlimit</h2>
<p>The bandlimit is set as <code>L</code> throughout the code and the CLIs. The default value
is set to <code>L=16</code> and the figures created in <a href="#paper-figures">the figure section</a>
all use <code>L=128</code>. The pre-computed data exists on
<a href="https://doi.org/10.5281/zenodo.7767698">Zenodo</a> for powers of two up to <code>L=128</code>.
Other values will be computed when running the appropriate code (and saved for
future use). Note that beyond <code>L=32</code> the code can be slow due to the
difficulties of computing the Slepian matrix prior to the eigendecomposition, as
such it is recommended to stick to the powers of two up to <code>L=128</code>.</p>
<h2 id="environment-variables">Environment Variables</h2>
<ul>
<li><code>NCPU</code>: sets the number of cores to use</li>
</ul>
<p>When it comes to selecting a Slepian region the order precedence is
<a href="https://doi.org/10.1111/j.1365-246X.2006.03065.x">polar cap region</a> &gt;
<a href="https://doi.org/10.1109/TSP.2016.2646668">limited latitude longitude region</a> &gt;
arbitrary region, <a href="src/sleplet/utils/region.py">as seen in the code</a>. The
default region is the <code>south_america</code> arbitrary region.</p>
<ul>
<li><code>POLAR_GAP</code></li>
<li>for a Slepian <code>polar cap region</code>, when set in conjunction with <code>THETA_MAX</code> but without the other <code>PHI</code>/<code>THETA</code> variables</li>
<li><code>THETA_MAX</code></li>
<li>for a Slepian <code>polar cap region</code>, when set without the other <code>PHI</code>/<code>THETA</code> variables</li>
<li>for a Slepian <code>limited latitude longitude region</code></li>
<li><code>THETA_MIN</code></li>
<li>for a Slepian <code>limited latitude longitude region</code></li>
<li><code>PHI_MAX</code></li>
<li>for a Slepian <code>limited latitude longitude region</code></li>
<li><code>PHI_MIN</code></li>
<li>for a Slepian <code>limited latitude longitude region</code></li>
<li><code>SLEPIAN_MASK</code></li>
<li>for an arbitrary Slepian region, currently <code>africa</code>/<code>south_america</code> supported</li>
</ul>
<h2 id="paper-figures">Paper Figures</h2>
<p>To recreate the figures from the below papers, one may use the CLI or the API.
For those which don't use the <code>mesh</code> or <code>sphere</code> CLIs, the relevant API code
isn't provided as it is contained within the <a href="./examples">examples folder</a>.</p>
<h3 id="sifting-convolution-on-the-sphere">Sifting Convolution on the Sphere</h3>
<p><a href="https://dx.doi.org/10.1109/LSP.2021.3050961"><img alt="Sifting Convolution on the Sphere" src="https://img.shields.io/badge/DOI-10.1109/LSP.2021.3050961-pink.svg"></a></p>
<h4 id="fig-1">Fig. 1</h4>
<pre><code class="language-sh">for ell in $(seq 2 -1 1); do
    sphere harmonic_gaussian -a 0.75 -b 0.125 -e ${ell} 1 -L 128 -m translate -o
done
</code></pre>
<pre><code class="language-python">import numpy as np
import pyssht as ssht

from sleplet.functions.flm.harmonic_gaussian import HarmonicGaussian
from sleplet.plotting.create_plot_sphere import Plot

for ell in range(2, 0, -1):
    f = HarmonicGaussian(L=128, l_sigma=10**ell, m_sigma=10)
    flm = f.translate(alpha=0.75 * np.pi, beta=0.125 * np.pi)
    f_sphere = ssht.inverse(flm, f.L, Method=&quot;MWSS&quot;)
    Plot(f_sphere, f.L, f&quot;fig_1_ell_{ell}&quot;, annotations=[]).execute()
</code></pre>
<h4 id="fig-2">Fig. 2</h4>
<pre><code class="language-sh">sphere earth -L 128
</code></pre>
<pre><code class="language-python">import pyssht as ssht

from sleplet.functions.flm.earth import Earth
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.harmonic_methods import rotate_earth_to_south_america

f = Earth(L=128)
flm = rotate_earth_to_south_america(f.coefficients, f.L)
f_sphere = ssht.inverse(flm, f.L, Method=&quot;MWSS&quot;)
Plot(f_sphere, f.L, &quot;fig_2&quot;).execute()
</code></pre>
<h4 id="fig-3">Fig. 3</h4>
<pre><code class="language-sh">for ell in $(seq 2 -1 1); do
    sphere harmonic_gaussian -c earth -e ${ell} 1 -L 128
done
</code></pre>
<pre><code class="language-python">import pyssht as ssht

from sleplet.functions.flm.earth import Earth
from sleplet.functions.flm.harmonic_gaussian import HarmonicGaussian
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.harmonic_methods import rotate_earth_to_south_america

for ell in range(2, 0, -1):
    f = HarmonicGaussian(L=128, l_sigma=10**ell, m_sigma=10)
    g = Earth(L=128)
    flm = f.convolve(f.coefficients, g.coefficients.conj())
    flm_rot = rotate_earth_to_south_america(flm, f.L)
    f_sphere = ssht.inverse(flm_rot, f.L, Method=&quot;MWSS&quot;)
    Plot(f_sphere, f.L, f&quot;fig_3_ell_{ell}&quot;).execute()
</code></pre>
<h3 id="slepian-scale-discretised-wavelets-on-the-sphere">Slepian Scale-Discretised Wavelets on the Sphere</h3>
<p><a href="https://dx.doi.org/10.1109/TSP.2022.3233309"><img alt="Slepian Scale-Discretised Wavelets on the Sphere" src="https://img.shields.io/badge/DOI-10.1109/TSP.2022.3233309-pink.svg"></a></p>
<h4 id="fig-2_1">Fig. 2</h4>
<pre><code class="language-sh">python -m examples.arbitrary.south_america.tiling_south_america
</code></pre>
<h4 id="fig-3_1">Fig. 3</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;south_america&quot;
# a
sphere earth -L 128 -s 2 -u
# b
sphere slepian_south_america -L 128 -s 2 -u
</code></pre>
<pre><code class="language-python">import pyssht as ssht

from sleplet.functions.flm.earth import Earth
from sleplet.functions.fp.slepian_south_america import SlepianSouthAmerica
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.harmonic_methods import rotate_earth_to_south_america
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

# a
f = Earth(L=128, smoothing=2)
flm = rotate_earth_to_south_america(f.coefficients, f.L)
f_sphere = ssht.inverse(flm, f.L, Method=&quot;MWSS&quot;)
Plot(f_sphere, f.L, &quot;fig_3_a&quot;, normalise=False).execute()
# b
region = Region(mask_name=&quot;south_america&quot;)
g = SlepianSouthAmerica(L=128, region=region, smoothing=2)
g_sphere = slepian_inverse(g.coefficients, g.L, g.slepian)
Plot(g_sphere, g.L, &quot;fig_3_b&quot;, normalise=False, region=g.region).execute()
</code></pre>
<h4 id="fig-4">Fig. 4</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;south_america&quot;
for p in 0 9 24 49 99 199; do
    sphere slepian -e ${p} -L 128 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian import Slepian
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;south_america&quot;)
for p in [0, 9, 24, 49, 99, 199]:
    f = Slepian(L=128, region=region, rank=p)
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_4_p_{p}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-5">Fig. 5</h4>
<pre><code class="language-sh">python -m examples.arbitrary.south_america.eigenvalues_south_america
</code></pre>
<h4 id="fig-6">Fig. 6</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;south_america&quot;
# a
sphere slepian_wavelets -L 128 -u
# b-f
for j in $(seq 0 4); do
    sphere slepian_wavelets -e 3 2 ${j} -L 128 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_wavelets import SlepianWavelets
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;south_america&quot;)
for j in [None, *list(range(5))]:
    f = SlepianWavelets(L=128, region=region, B=3, j_min=2, j=j)
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_6_j_{j}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-7">Fig. 7</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;south_america&quot;
# a
sphere slepian_wavelet_coefficients_south_america -L 128 -s 2 -u
# b-f
for j in $(seq 0 4); do
    sphere slepian_wavelet_coefficients_south_america -e 3 2 ${j} -L 128 -s 2 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_wavelet_coefficients_south_america import (
    SlepianWaveletCoefficientsSouthAmerica,
)
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;south_america&quot;)
for j in [None, *list(range(5))]:
    f = SlepianWaveletCoefficientsSouthAmerica(
        L=128, region=region, B=3, j_min=2, j=j, smoothing=2
    )
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_7_j_{j}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-8">Fig. 8</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;south_america&quot;
# a
sphere slepian_south_america -L 128 -n -10 -s 2 -u
# b-d
for s in 2 3 5; do
    python -m examples.arbitrary.south_america.denoising_slepian_south_america -n -10 -s ${s}
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_south_america import SlepianSouthAmerica
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.scripts.plotting_on_sphere import compute_amplitude_for_noisy_plots
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

# a
region = Region(mask_name=&quot;south_america&quot;)
f = SlepianSouthAmerica(L=128, region=region, noise=-10, smoothing=2)
f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
amplitude = compute_amplitude_for_noisy_plots(f)
Plot(
    f_sphere, f.L, &quot;fig_8_a&quot;, amplitude=amplitude, normalise=False, region=f.region
).execute()
</code></pre>
<h4 id="fig-9">Fig. 9</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;africa&quot;
# a
sphere earth -L 128 -s 2 -u -v africa
# b
sphere slepian_africa -L 128 -s 2 -u
</code></pre>
<pre><code class="language-python">import pyssht as ssht

from sleplet.functions.flm.earth import Earth
from sleplet.functions.fp.slepian_africa import SlepianAfrica
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.harmonic_methods import rotate_earth_to_africa
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

# a
f = Earth(L=128, smoothing=2)
flm = rotate_earth_to_africa(f.coefficients, f.L)
f_sphere = ssht.inverse(flm, f.L, Method=&quot;MWSS&quot;)
Plot(f_sphere, f.L, &quot;fig_9_a&quot;, normalise=False).execute()
# b
region = Region(mask_name=&quot;africa&quot;)
g = SlepianAfrica(L=128, region=region, smoothing=2)
g_sphere = slepian_inverse(g.coefficients, g.L, g.slepian)
Plot(g_sphere, g.L, &quot;fig_9_b&quot;, normalise=False, region=g.region).execute()
</code></pre>
<h4 id="fig-10">Fig. 10</h4>
<pre><code class="language-sh">python -m examples.arbitrary.africa.eigenvalues_africa
</code></pre>
<h4 id="fig-11">Fig. 11</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;africa&quot;
for p in 0 9 24 49 99 199; do
    sphere slepian -e ${p} -L 128 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian import Slepian
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;africa&quot;)
for p in [0, 9, 24, 49, 99, 199]:
    f = Slepian(L=128, region=region, rank=p)
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_11_p{p}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-12">Fig. 12</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;africa&quot;
# a
sphere slepian_wavelets -L 128 -u
# b
for j in $(seq 0 5); do
    sphere slepian_wavelets -e 3 2 ${j} -L 128 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_wavelets import SlepianWavelets
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;africa&quot;)
for j in [None, *list(range(6))]:
    f = SlepianWavelets(L=128, region=region, B=3, j_min=2, j=j)
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_12_j_{j}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-13">Fig. 13</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;africa&quot;
# a
sphere slepian_wavelet_coefficients_africa -L 128 -s 2 -u
# b
for j in $(seq 0 5); do
    sphere slepian_wavelet_coefficients_africa -e 3 2 ${j} -L 128 -s 2 -u
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_wavelet_coefficients_africa import (
    SlepianWaveletCoefficientsAfrica,
)
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

region = Region(mask_name=&quot;africa&quot;)
for j in [None, *list(range(6))]:
    f = SlepianWaveletCoefficientsAfrica(
        L=128, region=region, B=3, j_min=2, j=j, smoothing=2
    )
    f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
    Plot(f_sphere, f.L, f&quot;fig_13_j_{j}&quot;, normalise=False, region=f.region).execute()
</code></pre>
<h4 id="fig-14">Fig. 14</h4>
<pre><code class="language-sh">export SLEPIAN_MASK = &quot;africa&quot;
# a
sphere slepian_africa -L 128 -n -10 -s 2 -u
# b-d
for s in 2 3 5; do
    python -m examples.arbitrary.africa.denoising_slepian_africa -n -10 -s ${s}
done
</code></pre>
<pre><code class="language-python">from sleplet.functions.fp.slepian_africa import SlepianAfrica
from sleplet.plotting.create_plot_sphere import Plot
from sleplet.scripts.plotting_on_sphere import compute_amplitude_for_noisy_plots
from sleplet.utils.region import Region
from sleplet.utils.slepian_methods import slepian_inverse

# a
region = Region(mask_name=&quot;africa&quot;)
f = SlepianAfrica(L=128, region=region, noise=-10, smoothing=2)
f_sphere = slepian_inverse(f.coefficients, f.L, f.slepian)
amplitude = compute_amplitude_for_noisy_plots(f)
Plot(
    f_sphere, f.L, &quot;fig_14_a&quot;, amplitude=amplitude, normalise=False, region=f.region
).execute()
</code></pre>
<h3 id="slepian-scale-discretised-wavelets-on-manifolds">Slepian Scale-Discretised Wavelets on Manifolds</h3>
<p><a href="https://doi.org/10.48550/arXiv.2302.06006"><img alt="Slepian Scale-Discretised Wavelets on Manifolds" src="https://img.shields.io/badge/DOI-10.48550/arXiv.2302.06006-pink.svg"></a></p>
<h4 id="fig-2_2">Fig. 2</h4>
<pre><code class="language-sh">for r in $(seq 2 9); do
    mesh homer -e ${r} -u
done
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.harmonic_coefficients.mesh_basis_functions import MeshBasisFunctions
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.utils.harmonic_methods import mesh_inverse

mesh = Mesh(&quot;homer&quot;)
for r in range(2, 10):
    f = MeshBasisFunctions(mesh, rank=r)
    f_mesh = mesh_inverse(f.mesh, f.coefficients)
    Plot(mesh, f&quot;fig_2_r_{r}&quot;, f_mesh, normalise=False).execute()
</code></pre>
<h4 id="fig-4_1">Fig. 4</h4>
<pre><code class="language-sh">python -m examples.mesh.mesh_tiling homer
</code></pre>
<h4 id="fig-5_1">Fig. 5</h4>
<pre><code class="language-sh">python -m examples.mesh.mesh_region homer
</code></pre>
<h4 id="fig-6_1">Fig. 6</h4>
<pre><code class="language-sh">for p in 0 9 24 49 99 199; do
    mesh homer -m slepian_functions -e ${p} -u -z
done
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.slepian_coefficients.mesh_slepian_functions import (
    MeshSlepianFunctions,
)
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.utils.slepian_methods import slepian_mesh_inverse

mesh = Mesh(&quot;homer&quot;, zoom=True)
for p in [0, 9, 24, 49, 99, 199]:
    f = MeshSlepianFunctions(mesh, rank=p)
    f_mesh = slepian_mesh_inverse(f.mesh_slepian, f.coefficients)
    Plot(mesh, f&quot;fig_6_p_{p}&quot;, f_mesh, normalise=False, region=True).execute()
</code></pre>
<h4 id="fig-7_1">Fig. 7</h4>
<pre><code class="language-sh">python -m examples.mesh.mesh_slepian_eigenvalues homer
</code></pre>
<h4 id="fig-8_1">Fig. 8</h4>
<pre><code class="language-sh"># a
mesh homer -m slepian_wavelets -u -z
# b-f
for j in $(seq 0 4); do
    mesh homer -e 3 2 ${j} -m slepian_wavelets -u -z
done
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.slepian_coefficients.mesh_slepian_wavelets import (
    MeshSlepianWavelets,
)
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.utils.slepian_methods import slepian_mesh_inverse

mesh = Mesh(&quot;homer&quot;, zoom=True)
for j in [None, *list(range(5))]:
    f = MeshSlepianWavelets(mesh, B=3, j_min=2, j=j)
    f_mesh = slepian_mesh_inverse(f.mesh_slepian, f.coefficients)
    Plot(mesh, f&quot;fig_8_j_{j}&quot;, f_mesh, normalise=False, region=True).execute()
</code></pre>
<h4 id="fig-9_1">Fig. 9</h4>
<pre><code class="language-sh">mesh homer -m field -u
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.harmonic_coefficients.mesh_field import MeshField
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.utils.harmonic_methods import mesh_inverse

mesh = Mesh(&quot;homer&quot;)
f = MeshField(mesh)
f_mesh = mesh_inverse(f.mesh, f.coefficients)
Plot(mesh, &quot;fig_9&quot;, f_mesh, normalise=False).execute()
</code></pre>
<h4 id="fig-10_1">Fig. 10</h4>
<pre><code class="language-sh"># a
mesh homer -m slepian_wavelet_coefficients -u -z
# b-f
for j in $(seq 0 4); do
    mesh homer -e 3 2 ${j} -m slepian_wavelet_coefficients -u -z
done
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.slepian_coefficients.mesh_slepian_wavelet_coefficients import (
    MeshSlepianWaveletCoefficients,
)
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.utils.slepian_methods import slepian_mesh_inverse

mesh = Mesh(&quot;homer&quot;, zoom=True)
for j in [None, *list(range(5))]:
    f = MeshSlepianWaveletCoefficients(mesh, B=3, j_min=2, j=j)
    f_mesh = slepian_mesh_inverse(f.mesh_slepian, f.coefficients)
    Plot(mesh, f&quot;fig_10_j_{j}&quot;, f_mesh, normalise=False, region=True).execute()
</code></pre>
<h4 id="fig-11_1">Fig. 11</h4>
<pre><code class="language-sh"># a
mesh homer -m slepian_field -u -z
# b
mesh homer -m slepian_field -n -5 -u -z
# c
python -m examples.mesh.denoising_slepian_mesh homer -n -5 -s 2
</code></pre>
<pre><code class="language-python">from sleplet.meshes.classes.mesh import Mesh
from sleplet.meshes.slepian_coefficients.mesh_slepian_field import (
    MeshSlepianField,
)
from sleplet.plotting.create_plot_mesh import Plot
from sleplet.scripts.plotting_on_mesh import compute_amplitude_for_noisy_plots
from sleplet.utils.slepian_methods import slepian_mesh_inverse

mesh = Mesh(&quot;homer&quot;, zoom=True)
# a
f = MeshSlepianField(mesh)
f_mesh = slepian_mesh_inverse(f.mesh_slepian, f.coefficients)
Plot(mesh, &quot;fig_11_a&quot;, f_mesh, normalise=False, region=True).execute()
# b
g = MeshSlepianField(mesh, noise=-5)
g_mesh = slepian_mesh_inverse(g.mesh_slepian, g.coefficients)
amplitude = compute_amplitude_for_noisy_plots(g)
Plot(
    mesh, &quot;fig_11_b&quot;, g_mesh, amplitude=amplitude, normalise=False, region=True
).execute()
</code></pre>
<h4 id="fig-12_1">Fig. 12</h4>
<pre><code class="language-sh">for f in cheetah dragon bird teapot cube; do
    python -m examples.mesh.mesh_region ${f}
done
</code></pre>
<h4 id="tab-1">Tab. 1</h4>
<pre><code class="language-sh">python -m examples.mesh.produce_table
</code></pre>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: ../../README.md
&#34;&#34;&#34;

import logging

from sleplet._version import __version__

logging.basicConfig(
    format=&#34;[%(asctime)s] [%(levelname)s] --- %(message)s (%(filename)s:%(lineno)s)&#34;,
    datefmt=&#34;%Y-%m-%d %H:%M:%S&#34;,
    level=logging.INFO,
)
logger = logging.getLogger(__name__)</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="sleplet.data" href="data/index.html">sleplet.data</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.functions" href="functions/index.html">sleplet.functions</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.meshes" href="meshes/index.html">sleplet.meshes</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.plotting" href="plotting/index.html">sleplet.plotting</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.scripts" href="scripts/index.html">sleplet.scripts</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.slepian" href="slepian/index.html">sleplet.slepian</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="sleplet.utils" href="utils/index.html">sleplet.utils</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#sleplet">SLEPLET</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#bandlimit">Bandlimit</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#paper-figures">Paper Figures</a><ul>
<li><a href="#sifting-convolution-on-the-sphere">Sifting Convolution on the Sphere</a><ul>
<li><a href="#fig-1">Fig. 1</a></li>
<li><a href="#fig-2">Fig. 2</a></li>
<li><a href="#fig-3">Fig. 3</a></li>
</ul>
</li>
<li><a href="#slepian-scale-discretised-wavelets-on-the-sphere">Slepian Scale-Discretised Wavelets on the Sphere</a><ul>
<li><a href="#fig-2_1">Fig. 2</a></li>
<li><a href="#fig-3_1">Fig. 3</a></li>
<li><a href="#fig-4">Fig. 4</a></li>
<li><a href="#fig-5">Fig. 5</a></li>
<li><a href="#fig-6">Fig. 6</a></li>
<li><a href="#fig-7">Fig. 7</a></li>
<li><a href="#fig-8">Fig. 8</a></li>
<li><a href="#fig-9">Fig. 9</a></li>
<li><a href="#fig-10">Fig. 10</a></li>
<li><a href="#fig-11">Fig. 11</a></li>
<li><a href="#fig-12">Fig. 12</a></li>
<li><a href="#fig-13">Fig. 13</a></li>
<li><a href="#fig-14">Fig. 14</a></li>
</ul>
</li>
<li><a href="#slepian-scale-discretised-wavelets-on-manifolds">Slepian Scale-Discretised Wavelets on Manifolds</a><ul>
<li><a href="#fig-2_2">Fig. 2</a></li>
<li><a href="#fig-4_1">Fig. 4</a></li>
<li><a href="#fig-5_1">Fig. 5</a></li>
<li><a href="#fig-6_1">Fig. 6</a></li>
<li><a href="#fig-7_1">Fig. 7</a></li>
<li><a href="#fig-8_1">Fig. 8</a></li>
<li><a href="#fig-9_1">Fig. 9</a></li>
<li><a href="#fig-10_1">Fig. 10</a></li>
<li><a href="#fig-11_1">Fig. 11</a></li>
<li><a href="#fig-12_1">Fig. 12</a></li>
<li><a href="#tab-1">Tab. 1</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="sleplet.data" href="data/index.html">sleplet.data</a></code></li>
<li><code><a title="sleplet.functions" href="functions/index.html">sleplet.functions</a></code></li>
<li><code><a title="sleplet.meshes" href="meshes/index.html">sleplet.meshes</a></code></li>
<li><code><a title="sleplet.plotting" href="plotting/index.html">sleplet.plotting</a></code></li>
<li><code><a title="sleplet.scripts" href="scripts/index.html">sleplet.scripts</a></code></li>
<li><code><a title="sleplet.slepian" href="slepian/index.html">sleplet.slepian</a></code></li>
<li><code><a title="sleplet.utils" href="utils/index.html">sleplet.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>